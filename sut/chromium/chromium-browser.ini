# Copyright (c) 2019-2020 Renata Hodovan, Akos Kiss.
#
# Licensed under the BSD 3-Clause License
# <LICENSE-BSD-3-Clause.rst or https://opensource.org/licenses/BSD-3-Clause>.
# This file may not be copied, modified, or distributed except according to
# those terms.

##################
#    Browser    #
#################

# This config defines how to fuzz the Chrome or Content Shell binaries.

[sut.chromium]
call=fuzzinator.call.StreamMonitoredSubprocessCall
reduce_call=${call}

[chromium]
call_command=./${chromium:binary} --single-process --no-sandbox {test}
reduce_command=${call_command}

[sut.chromium.call.init]
end_patterns=${sut.chromium.call.decorate(2):stderr}
cwd=${chromium:build_dir}
command=${chromium:call_command}
timeout=${chromium:call_timeout}
env={"ASAN_OPTIONS": "handle_abort=1:symbolize=true:allow_addr2line=true:abort_on_error=true:detect_stack_use_after_return=1:check_initialization_order=true:strict_init_order=true:exitcode=199"}

[sut.chromium.reduce_call.init]
end_patterns=${sut.chromium.reduce_call.decorate(2):stderr}
cwd=${chromium:build_dir}
command=${chromium:reduce_command}
timeout=${chromium:reduce_call_timeout}
env=${sut.chromium.call.init:env}
